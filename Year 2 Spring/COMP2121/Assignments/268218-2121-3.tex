\documentclass{article}

% ------------------------------------ %
%             Document Info            %
% ------------------------------------ %

\usepackage{../../../LaTeX-Preamables/Assign}

\begin{document}
\newcommand{\documentcourse}{COMP2121}
\newcommand{\documentnumber}{3}

% ------------------------------------ %
%                Header                %
% ------------------------------------ %

\input{../../../LaTeX-Preamables/AssignHead-V1.tex}

% ------------------------------------ %
%                Content               %
% ------------------------------------ %

\section*{Question 1}
\hrule
\vspace{0.5cm}

\begin{enumerate}
    \item Basics of Counting [21 Marks]
          \begin{enumerate}
              \item (5 marks) At ABC bank, accounts have six-digit pin numbers. Three of the digits must come from
                    $\{1, 2, 3, 4\}$. The remaining three digits must come from $\{6, 7, 8, 9\}$. Repetition of digits is allowed.
                    How many pin numbers are possible at ABC bank?

              \item (5 marks) Suppose that six distinct integers are chosen from the set $S = \{3, 4, 5, 6, 7, 8, 9, 10, 11, 12\}$.
                    Show that there must be two chosen integers whose sum is $15$.

              \item (5 marks) Let $n, k \in \mathbb{Z}^+$ with $k < n$. Give a combinatorial proof of the following identity:
                    \[
                        \binom{n}{k} = \binom{n-1}{k} + \binom{n-1}{k-1}.
                    \]

              \item (6 marks) Alice is tasked with finding the number of primes less than or equal to $111$. She notices that all
                    the composite numbers in the set $A = \{1, 2, \dots, 111\}$ are divisible by at least one of the primes
                    $p_1 = 2$, $p_2 = 3$, $p_3 = 5$, and $p_4 = 7$. Let $A_{p_i}$ denote the subset of multiples of $p_i$ in $A$.
                    Use the Inclusion-Exclusion Principle to help Alice solve her task.
          \end{enumerate}
\end{enumerate}

\subsection*{Solutions to question 1}

\begin{enumerate}[label=(\alph*)]
    \item The number of ways is:
          \[
              \binom{6}{3} \times 4^3 \times 4^3 = 81920
          \]
    \item The integers in $S$ can be paired as follows:
          \[
              (3, 12), (4, 11), (5, 10), (6, 9), (7, 8).
          \]
          Since there are six integers chosen from $S$, at least one of the pairs must have both integers chosen.
          Hence, there must be two integers whose sum is $15$.
    \item \[
              \begin{aligned}
                  \binom{n-1}{k} + \binom{n-1}{k-1} & = \frac{(n-1)!}{k!(n-1-k)!} + \frac{(n-1)!}{(k-1)!(n-1-(k-1))!}           \\
                                                    & = \frac{(n-1)!}{k!(n-k-1)!} + \frac{(n-1)!}{(k-1)!(n-k)!}                 \\
                                                    & = \frac{(n-1)!}{k!(n-k)!} \cdot (n-k) + \frac{(n-1)!}{(k)!(n-k)!} \cdot k \\
                                                    & = \frac{(n-1)!}{k!(n-k)!} \cdot (n-k+k)                                   \\
                                                    & = \frac{(n-1)!}{k!(n-k)!} \cdot n                                         \\
                                                    & = \frac{n!}{k!(n-k)!}                                                     \\
                                                    & = \binom{n}{k}
              \end{aligned}
          \]
    \item Using the Inclusion-Exclusion Principle, we have:
          \[
              |A_{2} \cup A_{3} \cup A_{5} \cup A_{7}| = |A_{2}| + |A_{3}| + |A_{5}| + |A_{7}| - |A_{2} \cap A_{3}| - |A_{2} \cap A_{5}| - |A_{2} \cap A_{7}|
          \]
          \[
              - |A_{3} \cap A_{5}| - |A_{3} \cap A_{7}| - |A_{5} \cap A_{7}| + |A_{2} \cap A_{3} \cap A_{5}| + |A_{2} \cap A_{3} \cap A_{7}| + |A_{2} \cap A_{5} \cap A_{7}|
          \]
          \[
              + |A_{3} \cap A_{5} \cap A_{7}| - |A_{2} \cap A_{3} \cap A_{5} \cap A_{7}|.
          \]
          The number of multiples of $k$ in $S$ is given by $\left\lfloor\frac{111}{k}\right\rfloor$. Hence:
          \begin{align*}
              |A_2|                            & = 55 \\
              |A_3|                            & = 37 \\
              |A_5|                            & = 22 \\
              |A_7|                            & = 15 \\
              |A_2 \cap A_3|                   & = 18 \\
              |A_2 \cap A_5|                   & = 11 \\
              |A_2 \cap A_7|                   & = 7  \\
              |A_3 \cap A_5|                   & = 7  \\
              |A_3 \cap A_7|                   & = 5  \\
              |A_5 \cap A_7|                   & = 3  \\
              |A_2 \cap A_3 \cap A_5|          & = 3  \\
              |A_2 \cap A_3 \cap A_7|          & = 2  \\
              |A_2 \cap A_5 \cap A_7|          & = 1  \\
              |A_3 \cap A_5 \cap A_7|          & = 1  \\
              |A_2 \cap A_3 \cap A_5 \cap A_7| & = 0
          \end{align*}
          Substituting these values into the Inclusion-Exclusion formula gives:
          \[
              |A_{2} \cup A_{3} \cup A_{5} \cup A_{7}| = 55 + 37 + 22 + 15 - (18 + 11 + 7 + 7 + 5 + 3) + (3 + 2 + 1 + 1) - 0 = 85
          \]
          Hence, $85$ numbers are divisible by $2,3,5,7$. The number of primes is $111-85+4-1=29$. ($2,3,5,7$ are primes, and subtract 1 as $1$ is not prime.)
\end{enumerate}


\newpage
\section*{Question 2}
\hrule
\vspace{0.5cm}
\begin{enumerate}
    \item Permutations and Combinations [19 Marks]
          \begin{enumerate}
              \item (5 marks) In how many ways can the letters of the word \textbf{ENTANGLEMENT} be arranged if:

                    \begin{enumerate}
                        \item the arrangement starts with \textbf{G} and ends with \textbf{L}?
                        \item all vowels occur together in the arrangement?
                    \end{enumerate}
              \item (7 marks) At a college Tic-Tac-Toe club, the members think of the following problem. The standard game of Tic-Tac-Toe is played on a \(3 \times 3\) grid between two players. The players take alternate turns with the first player entering an \textbf{X} in one of the 9 grid positions and the second player entering an \textbf{O} in one of the 9 grid positions. To win the game, the first player must get three \textbf{X}'s in a row (either vertical, horizontal, or diagonal). Similarly, the second player must get three \textbf{O}'s in a row. We do not assume that the players are rational, but they follow the rules of the game.

                    How many Tic-Tac-Toe games are possible that end on the fifth turn (both players included) with the first player as the winner?

              \item (7 marks) Charlie has \(2n\) distinct coins labelled \(1, 2, \dots, 2n\) in his coin collection, for some \(n \in \mathbb{Z}^+\). An arrangement \((c_1, c_2, \dots, c_{2n})\) of the coins is found to be pleasant if there is at least one \(i \in \{1, 2, \dots, 2n - 1\}\) for which \(|c_i - c_{i+1}| = n\). Show that for any positive integer \(n\), at least half of all possible permutations of Charlie's coins will be pleasant.

          \end{enumerate}
\end{enumerate}

\subsection*{Solutions to question 2}

\begin{enumerate}[label=(\alph*)]
    \item
          \begin{enumerate}[label=(\roman*)]
              \item Frequencies of letters other than \textbf{G} and \textbf{L}: `E:3, N:3, T:2, A:1, M:1'. The number of arrangements is:
                    \[
                        \frac{10!}{3! \cdot 3! \cdot 2!} = 50400
                    \]
              \item Treat `EEEA` as a single block. The remaining frequencies are `N:3, T:2, G:1, M:1, L:1`:
                    \[
                        \frac{9!}{3! \cdot 2!} = 30240
                    \]
                    Arrangement of the vowels: frequencies `E:3, A:1`:
                    \[
                        \frac{4!}{3! \cdot 1!} = 4
                    \]
                    Hence, the total number of arrangements is:
                    \[
                        30240 \cdot 4 = 120960
                    \]
          \end{enumerate}
    \item
          Winning lines for \textbf{X} occurs at 3 horizontal, 3 vertical and 2 diagonals lines. There are a total of $8$ winning lines. For each line, there are $3! = 6$ ways to place each \textbf{X}.

          At turn 2, \text{O} can be placed at (one of) $9-3=6$ cells for \textbf{X} to win. At turn 4, \textbf{X} can be placed at (one of) $9-4=5$ cells.

          Hence, number of possible games that end of 5th turn with \textbf{X} winning is:
          \[
              \begin{aligned}
                  N & = \text{No. arrangements for one of the winning lines} \times \textbf{No. winning lines} \\
                    & = (5 \times 6 \times 6) \times 8                                                         \\
                    & = 1440
              \end{aligned}
          \]
    \item
          The sequence of numbers can be represented as \( (1, 2, \dots, n, n+1, \dots, 2n) \). We can group each element indexed $i$ with $i+n$ to identify the pairs of numbers which satisfy $|c_i - c_{i+1}| = n$.

          Hence, the total number of groups is $n$.

          Numbers in each group must be adjacent to each other. Hence, there are $(2n-1)! \times 2$ ways to pleasantly arrange the numbers of the sequence in the way of one of the groups.

          To find the number of pleasant arrangements, we must first find the number of common permutations for each group. (for example, $n=2, 4,2,3,1$ satisfies both groups $(4,2),(3,1)$.)

          This is given by $(2n-2)!\times2\times2=4(2n-2)!$ for each group (as we locked in 2 groups ($-2$), 2 ways to arrange first group, 2 ways to arrange second group).

          Hence, total number of pleasant arrangements is:
          \[
              (2n-1)! \times 2 \times n - 4(2n-2)! \times (n-1) > \frac{1}{2} \times (2n)!,\quad n \geq 1
          \]
          The relative size can be identified by plotting the functions. Hence, the number of pleasant arrangements is at least half of all possible arrangements.

\end{enumerate}

\newpage
\section*{Question 3}
\hrule
\vspace{0.5cm}

\begin{enumerate}[label=(\alph*)]
    \item (7 marks) Let \( A = (a_1, a_2, \dots, a_n) \) be a sequence of \( n \) positive integers arranged in increasing order. Show that there must exist some consecutive sum (that is, \( a_i + a_{i+1} + \dots + a_j \) for some \( i < j \)) that is a positive multiple of \( n \).

    \item (7 marks) At the beginning of the 2024 season, 20 players from the Manchester City football squad lined up in a row to take a team picture. At the end of their winning season, the coach decided to take another team picture of the same 20 players, but such that everyone had a different right-hand neighbour in the new picture. In how many ways could they have arranged the players to take the new picture?

    \item (7 marks) Bob has 100 identical coins in his collection which he splits into six sets of coins to be sent to six exhibitions (where it is possible to send 0 coins to an exhibition). In how many ways can he do this if the total number of coins sent to the first three exhibitions must exceed the total number of coins sent to the last three?

    \item (7 marks) How many solutions are there to the equation \( x_1 + x_2 + x_3 + x_4 = 12 \) with \( 1 \leq x_i \leq 4 \) for all \( i \in \{1, \dots, 4\} \)?
\end{enumerate}

\subsection*{Solutions to question 3}
\begin{enumerate}[label=(\alph*)]
    \item Note that the question has be ammended to $i \leq j$ instead of $i < j$. Let the proposition of the question be $P$.

          Consider the base case $n=1$. There is only one consecutive sum, and any number is a number divisible by $1$.

          Let's define a \textbf{partial} consecutive sum $S_i = a_1 + \ldots + a_i$, and the subtraction of two sums is $S_j - S_i = a_{i+1} + \ldots + a_j$.

          Hence, there are a total of $n$ partial consecutive sums from $S_1 \dots S_n$.

          $S=\{S_1,\ldots,S_n\} \% n \in M=\{0,\ldots,n-1\}$. If $S_i \% n = 0$, then $P$ is true. Else, since $|S| = n > |M|$, by the pigeonhole principle, there must be be a pair $(S_i,S_j)$ such that $S_i \% n = S_j \% n$. By definition of MOD, $(S_j - S_i) \% n = 0$. Therefore, in this case, there must be a consecutive sum $(S_j-S_i)$ that is a multiple of $n$.

    \item The total number of ways to arrange the players without restirctions is $20!$.

          Denote original permutation be $A=(a_1,a_2,\ldots,a_{20})$. In the new permutation, we must avoid pairs of $(a_i,a_{i+1})$, where there are a total of $19$ pairs ($a_{20}$ makes no pairs).

          Considering a general problem, the total number of ways to arrange $n$ players without restrictions is $n!$.

          Subtract the invalid arrangements. There are $n-1$ pairs, and treating a pair as one entity, there are $(n-1)!$ permutations. This gives $(n-1)(n-1)!$ permutations.

          However, in those permutations, there might be cases where two pairs exists in the same permutation, and we would've double counted them. Hence, we have to add $\binom{n-1}{2}(n-2)!$ permutations.

          In then those permutations, there might be cases where three pairs exists in the same permutation, and we would've triple counted them. Hence, we have to subtract $\binom{n-1}{3}(n-3)!$ permutations.

          Hence, the expression of the solution is:

          \[
              \sum_{k=0}^{19}(-1)^k\binom{19}k(20-k)!
          \]

    \item The number of ways to put $100$ coins in $6$ boxes is given by $\binom{100+6-1}{6-1} = \binom{105}{5}$, without constraints.

          Denote coins in box i be $b_i$. We need $b_1+b_2+b_3 > b_4+b_5+b_6$. This basically means that we need $b_1+b_2+b_3 \neq b_4+b_5+b_6 \neq 50$ and $b_1+b_2+b_3 > 50, b_4+b_5+b_6 < 50$

          The number of ways to put $50$ coins in $3$ boxes is given by $\binom{50+3-1}{3-1} = \binom{52}{2}$. As there are two sides, the total number of ways to allocate the $100$ coins, where each side have $50$ coins, is $\binom{52}{2}^2$.

          \begin{align*}
              \text{Ways to put 100 coins in 6 boxes}                                         & = \binom{105}{5}                   \\
              \text{Ways to put 50 coins in 3 boxes}                                          & = \binom{52}{2}                    \\
              \text{Ways to put 100 coins in 6 boxes, where each side has 50 coins}           & = \binom{52}{2}^2                  \\
              \text{Ways to put 100 coins in 6 boxes, where each side has more than 50 coins} & = \binom{105}{5} - \binom{52}{2}^2
          \end{align*}

          As we need to have the first side have more than 50 coins, we simply have to divide the above by 2:
          \[
              \text{No. of ways}=\frac{1}{2} \left( \binom{105}{5} - \binom{52}{2}^2 \right)
          \]

    \item The solutions are $(1+3+4+4), (2+2+4+4), (2+3+3+4), (3+3+3+3)$. Each of the unique numbers can be in any order:
          \begin{align*}
              \frac{4!}{2!} + \frac{4!}{2! \times 2!} + \frac{4!}{2!} + 1 = 31
          \end{align*}
\end{enumerate}

\newpage
\section*{Question 4}
\hrule
\vspace{0.5cm}

\begin{enumerate}
    \item Basics of Probability Theory [18 Marks]
          \begin{enumerate}
              \item (5 marks) Let \( p := p_1 p_2 \dots p_n \) denote a randomly chosen \( n \)-permutation of the set \(\{1, 2, \dots, n\}\). Let \( A \) denote the event that \( p_1 > p_2 \) and let \( B \) denote the event that \( p_2 > p_3 \). Are \( A \) and \( B \) independent events? Prove your answer.

              \item (6 marks) In a particular football league, no draws are allowed (games are concluded using penalties in the event of a draw), and home teams win 60 percent of the games. Jimmy is a gambler who tries to predict the outcome of each game. In the long term, he correctly predicts a home team win for 85\% of the games that are actually won by the home team, and he incorrectly predicts a home win for 10\% of the games that are then won by the visiting team.

                    If Jimmy predicts that the home team will win a given game, what is the probability that his prediction is correct?

              \item (7 marks) A particular roulette wheel works as follows. When the wheel is spun once, there are 36 possible outcomes: 18 red numbers and 18 black numbers (note that this is in contrast to usual roulette wheels which have one or two greens as well). In each spin, all outcomes are equally likely, and successive spins are independent of each other.

                    The wheel is switched on by the dealer Emma one morning. What is the probability that she observes a run of 4 reds before a run of 2 blacks, where a run of 4 reds indicates a sequence of 4 consecutive red outcomes?
          \end{enumerate}
\end{enumerate}

\subsection*{Solutions to question 4}

\begin{enumerate}[label=(\alph*)]
    \item For two events to be independent, $P(A \cup B) = P(A) \times P(B)$. Let $a,b,c$ be the 3 numbers chosen randomly from the set, where $a>b>c$, the following are all possible permutations:
          \[
              (p_1,p_2,p_3) := (a,b,c),\ (a,c,b),\ (b,a,c),\ (b,c,a),\ (c,a,b),\ (c,b,a)
          \]\
          We have $P(A) = \frac12, P(B) = \frac12, P(A\cup B) = \frac16 \implies P(A)\times P(B) = \frac14 \neq \frac16$. Therefore, events are not independent.
    \item \begin{align*}
              \text{Prob. H win} = P(H)                         & = .6                                               \\
              \text{Prob. Jimmy makes prediction of H team win} & = P(P)                                             \\
              \text{Prob. H lose} = P(H')                       & = .4                                               \\
              P(P | H)                                          & = .85                                              \\
              P(P | H')                                         & = .1                                               \\
              P(P)                                              & = P(P|H)P(H) + P(P|H')P(H')                        \\
                                                                & = .85 \cdot .6 + .1 \cdot .4                       \\
                                                                & = .55                                              \\
              \text{We need to find } P(H|P)                    & = \frac{P(P|H)P(H)}{P(P)} \text{ (Bayes' theorem)} \\
                                                                & = \frac{.85 \cdot .6}{.55}                         \\
                                                                & = \frac{51}{55} \approx 0.9273
          \end{align*}
    \item We only need to focus on fulfilling the first 4 reds, since the black will be automatically fulfilled after 2 reds.
          \begin{itemize}
              \item $S$: Starting point of this sequence of observations
              \item $Rn$: First consecutive observation of $n$-th red
              \item $Bn$: First observation of $n$-th black
          \end{itemize}
          For each time we run the roulette, observe the following (recursive) states (independent events):
          \begin{align*}
              P_S    & = 0.5P_{R1} + 0.5P_{B1} \\
              P_{R1} & = 0.5P_{R2} + 0.5P_{B1} \\
              P_{R2} & = 0.5P_{R3} + 0.5P_{B1} \\
              P_{R3} & = 0.5 + 0.5P_{B1}       \\
              P_{B1} & = 0.5P_{R1}             \\
          \end{align*}

          Solving the simultaneous equations, we get:
          \begin{align*}
              P_{R_1} & = 0.5P_{R_2} + 0.5\times0.5P_{R_1} \implies P_{R_1}=\frac23P_{R_2}=\frac29 \\
              P_{R_2} & = 0.5P_{R_3} + 0.5\times0.5P_{R_1} \implies P_{R_2}=\frac35P_{R_3}=\frac13 \\
              P_{R_3} & = 0.5 + 0.5\times0.5P_{R_1} \implies P_{R_3}=\frac59                       \\
              P_S     & = 0.5P_{R_1} + 0.5\times0.5 \times P_{R_1}                                 \\
                      & = 0.5\times\frac29 + 0.25\times\frac29 = \frac16
          \end{align*}
\end{enumerate}

\newpage
\section*{Question 5}
\hrule
\vspace{0.5cm}

\begin{enumerate}
    \item Probability Distributions, Expected Value and Variance [14 Marks]
          \begin{enumerate}
              \item (7 marks) Alison has given Robin two gift certificates for a certain raffle. The organizers sell 100 raffle tickets for each weekly draw. One of these tickets is selected by a uniformly random process, and the lucky ticket holder wins ten thousand dollars. The other 99 ticket holders win nothing.

                    Robin can use his gift in two ways: either he can buy two tickets for the same week, or he can buy one ticket in each of two weeks. Robin comes to you for advice to find the better (less risky) strategy in terms of the expected value and variance of his potential winnings. By means of an explicit calculation, advise Robin as to the strategy he should follow.

              \item (7 marks) A coin is biased such that a head is four times as likely to occur as a tail. Let \( X_m \) be the random variable that equals the number of heads minus the number of tails when the coin is flipped \( m \) times. Compute the expected value and variance of \( X_m \).
          \end{enumerate}
\end{enumerate}


\subsection*{Solutions to question 5}

\begin{enumerate}[label=(\alph*)]
    \item If Robin buys two tickets for the same week:
          \begin{align*}
              E        & = 0.02 \cdot 10000 = 200               \\
              \sigma^2 & = 0.02 \cdot 10000^2 - 200^2 = 1960000
          \end{align*}
          If Robin buys one ticket in each of two weeks:
          \begin{align*}
              E        & = 0.01 \cdot 10000 + 0.01 \cdot 10000 = 200            \\
              \sigma^2 & = (0.01 \times 0.99 \times 10000^2) \times 2 = 1980000
          \end{align*}
          Hence, the expected value are the same for both strategies, but the variance for the first strategy is less than the variance for the second strategy. Hence, Robin should buy two tickets for the same week.
    \item Let \( p \) be the probability of getting a head. Then, \( p = \frac{4}{5} \) and \( 1-p = \frac{1}{5} \). Let $X_i$ be the outcome of the $i$-th flip:
          \begin{align*}
              X_i      & = \begin{cases}
                               1  & \text{if head} \\
                               -1 & \text{if tail}
                           \end{cases}              \\
              X_m      & = \sum_{i=1}^{m} X_i               \\
              E(X_i)   & = p - (1-p)                        \\
                       & = \frac35                          \\
              E(X_i^2) & = p \cdot 1^2 + (1-p) \cdot (-1)^2 \\
                       & = p + (1-p)                        \\
                       & = 1                                \\
              Var(X_i) & = E(X_i^2) - (E(X_i))^2            \\
                       & = 1 - {\frac35}^2                  \\
                       & = \frac{16}{25}                    \\
          \end{align*}
          Hence, $E(X_m) = m(\frac{3}{5})$ and $Var(X_m) = m(\frac{16}{25})$.
\end{enumerate}

\end{document}
